#!/usr/bin/env node

/**
 * power-assert.js - Empower your assertions
 *
 * https://github.com/twada/power-assert.js
 *
 * Copyright (c) 2013 Takuto Wada
 * Licensed under the MIT license.
 *   https://raw.github.com/twada/power-assert.js/master/MIT-LICENSE.txt
 */
var empower = require('../lib/empower'),
    esprima = require('esprima'),
    escodegen = require('escodegen'),
    argv = require('optimist').argv,
    fs = require('fs'),
    options = {},
    file = argv._[0],
    path = fs.realpathSync(file),
    source = fs.readFileSync(file, 'utf-8'),
    tree = esprima.parse(source, {tolerant: true, loc: true, range: true});

options['path'] = path;
options['source'] = source;
tree = empower(tree, options);
console.log(escodegen.generate(tree));
